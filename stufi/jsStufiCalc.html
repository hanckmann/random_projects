<!-- This example is from JavaScript: The Definitive Guide, 3rd Edition.   -->
<!-- That book and this example were Written by David Flanagan.            -->
<!-- They are Copyright (c) 1996, 1997, 1998 O'Reilly & Associates.        -->
<!-- This example is provided WITHOUT WARRANTY either expressed or implied.-->
<!-- You may study, use, modify, and distribute it for any purpose,        -->
<!-- as long as this notice is retained.                                   -->

<!-- 
  This is an HTML form that allows the user to enter data, and allows
  JavaScript to display the results it computes back to the user. The
  form elements are embedded in a table to improve their appearance.
  Note that some of the form elements define "onChange" or "onClick"
  event handlers. These specify strings of JavaScript code to be
  executed when the user enters data or clicks on a button. 
-->
<FORM NAME="leninginfo">
  <TABLE>
    <TR><TD COLSPAN=3><BIG><B>IBGroep info:</B></BIG></TD></TR>
    <TR>
      <TD>1)</TD>
      <TD>Lening:</TD>
      <!--<TD><INPUT TYPE=text NAME=lening SIZE=12 onChange="calculate()"></TD>-->
      <TD><INPUT TYPE=text NAME=lening SIZE=12"></TD>
    </TR>
    <TR>
      <TD>2)</TD>
      <TD>Rente (op jaarbasis):</TD>
      <TD><INPUT TYPE=text NAME=ibgrente SIZE=12"></TD>
    </TR>
    <TR>
      <TD>3)</TD>
      <TD>Aflossing per maand:</TD>
      <TD><INPUT TYPE=text NAME=aflossing SIZE=12"></TD>
    </TR>
    <TR><TD COLSPAN=3><BIG><B>Extra aflossing info:</B></BIG></TD></TR>
    <TR>
      <TD>4)</TD>
      <TD>Extra betaling per maand:</TD>
      <TD><INPUT TYPE=text NAME=extra SIZE=12"></TD>
    </TR>
    <TR>
      <TD>5)</TD>
      <TD>Rente bij de bank (op jaarbasis):</TD>
      <TD><INPUT TYPE=text NAME=bankrente SIZE=12"></TD>
    </TR>
    <TR><TD COLSPAN=3>
      <BIG><B>
        <INPUT TYPE=button VALUE="Bereken" onClick="calculate()">
      </B></BIG>
    </TD></TR>
    <TR><TD COLSPAN=3><BIG><B>Kosten overzicht bij minimale aflossing:</B></BIG></TD></TR>
    <TR>
      <TD>A)</TD>
      <TD>Aflossingstijd (in maanden):</TD>
      <TD><INPUT TYPE=text NAME=a_tijd SIZE=12></TD>
    </TR>
    <TR>
      <TD>B)</TD>
      <TD>totaale kosten lening:</TD>
      <TD><INPUT TYPE=text NAME=a_totaal SIZE=12></TD>
    </TR>
    <TR><TD COLSPAN=3><BIG><B>Kosten overzicht bij extra aflossing:</B></BIG></TD></TR>
    <TR>
      <TD>A)</TD>
      <TD>Aflossingstijd (in maanden):</TD>
      <TD><INPUT TYPE=text NAME=b_tijd SIZE=12></TD>
    </TR>
    <TR>
      <TD>B)</TD>
      <TD>totaale kosten lening:</TD>
      <TD><INPUT TYPE=text NAME=b_totaal SIZE=12></TD>
    </TR>
    <TR><TD COLSPAN=3><BIG><B>Kosten overzicht bij minimale aflossing en extra banksparen (als het gespaarde bedrag wordt gebruikt om zo snel mogelijk de lening af te lossen):</B></BIG></TD></TR>
    <TR>
      <TD>A)</TD>
      <TD>Aflossingstijd (in maanden):</TD>
      <TD><INPUT TYPE=text NAME=c_tijd SIZE=12></TD>
    </TR>
    <TR>
      <TD>B)</TD>
      <TD>Gespaard bedrag (incl. rente):</TD>
      <TD><INPUT TYPE=text NAME=c_gespaard SIZE=12></TD>
    </TR>
    <TR>
      <TD>C)</TD>
      <TD>totaale kosten lening:</TD>
      <TD><INPUT TYPE=text NAME=c_totaal SIZE=12></TD>
    </TR>
  </TABLE>
</FORM>

<!--
  This is the JavaScript program that makes the example work. Note that
  this script defines the calculate() function called by the event
  handlers in the form.
-->
<SCRIPT LANGUAGE="javascript">
function calculate() {
    // Get the user's input from the form. Assume it is all valid.
    // Convert interest from a percentage to a decimal, and convert from
    // an annual rate to a monthly rate. Convert payment period in years
    // to the number of monthly payments.
    var lening = document.leninginfo.lening.value;
    var ibgrente = document.leninginfo.ibgrente.value / 100 / 12;
    var aflossing = document.leninginfo.aflossing.value;
    var extra = document.leninginfo.extra.value;
    var bankrente = document.leninginfo.bankrente.value / 100 / 12;

	var rest = 0;
	var maanden = 0;

	// Bereken de kosten bij minimale aflossing
	rest = lening;
	maanden = 0;
	
	while (rest > 0){
		maanden = maanden + 1;
		rest = rest * (1 + ibgrente);
		rest = rest - aflossing;
	}

	document.leninginfo.a_tijd.value = "bla2";


	document.leninginfo.a_tijd.value = maanden;
	document.leninginfo.a_totaal.value = maanden * aflossing + rest;
/*
	// Bereken de kosten bij minimale aflossing
	rest = lening;
	maanden = 0;
	
	
	
	while (rest > 0){
		document.leninginfo.a_tijd.value = maanden;
		maanden = maanden + 1;
		rest = rest * (1 + ibgrente);
		rest = rest - (aflossing - extra);
	}
	
	document.leninginfo.b_tijd.value = maanden;
	document.leninginfo.b_totaal.value = maanden * (aflossing + extra) + rest;


	// Bereken de kosten bij terug betalen en extra banksparen
	rest = lening;
	maanden = 0;
	var gespaard = 0;
	
	while (rest > gespaard){
		document.leninginfo.a_tijd.value = maanden;
		maanden = maanden + 1;
		rest = rest * (1 + ibgrente);
		rest = rest - (aflossing - extra);
		gespaard = gespaard * (1 + bankrente);
		gespaard = gespaard + extra;

	}
	
	document.leninginfo.c_tijd.value = maanden;
	document.leninginfo.c_gespaard.value = gespaard;
	document.leninginfo.c_totaal.value = (maanden * (aflossing + extra) + rest - gespaard;
/*

    // Now compute the monthly payment figure, using esoteric math.
    var x = Math.pow(1 + interest, payments);
    var monthly = (principal*x*interest)/(x-1);

    // Check that the result is a finite number. If so, display the results
    if (!isNaN(monthly) && 
        (monthly != Number.POSITIVE_INFINITY) &&
        (monthly != Number.NEGATIVE_INFINITY)) {

        document.leninginfo.payment.value = round(monthly);
        document.leninginfo.totaal.value = round(monthly * payments)
        document.leninginfo.totaalinterest.value = 
            round((monthly * payments) - principal);
    }
    // Otherwise, the user's input was probably invalid, so don't
    // display anything.
    else {
        document.leninginfo.payment.value = "";
        document.leninginfo.totaal.value = "";
        document.leninginfo.totaalinterest.value = "";
    }
*/
}

// This simple method rounds a number to two decimal places.
function round(x) {
  return Math.round(x*100)/100;
}
</SCRIPT>
